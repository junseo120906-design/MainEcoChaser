<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>EcoChaser - 친환경 분리수거 러닝 게임</title>
	
	<!-- Open Graph 메타 태그 (카카오톡, SNS 공유 시 미리보기) -->
	<meta property="og:type" content="website">
	<meta property="og:title" content="EcoChaser - 친환경 분리수거 게임">
	<meta property="og:description" content="달리면서 쓰레기를 올바르게 분리수거하는 재미있는 환경 게임! 🌍♻️">
	<meta property="og:image" content="https://your-domain.com/preview.jpg">
	<meta property="og:url" content="https://your-domain.com">
	<meta name="description" content="달리면서 쓰레기를 올바르게 분리수거하는 재미있는 환경 게임!">
	
	<!-- 카카오톡 SDK -->
	<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js" 
		integrity="sha384-TiCUE00h+MXfNPbg/EKYgF2R8NDEMql3eWxmANtBq8nkqTj7EzfLsVqrXE1mY48i" 
		crossorigin="anonymous"></script>
	
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<div id="gameContainer"></div>

	<div id="scoreBox"><span id="scoreLabel"></span> <span id="score">0</span></div>
	<div id="scoreEffect"></div>
	<div id="timerBox"><span id="timerLabel">남은 시간:</span> <span id="timeLeft">30</span><span id="timeUnit">초</span></div>
	<div id="tierBadgeHud"></div>
	
	<!-- 인게임 설정 버튼 -->
	<button id="settingsBtn" class="hud-button" style="display: none;">⚙️</button>

	<!-- 오답 말풍선 (캐릭터 위) -->
	<div id="wrongAnswerBubble" class="speech-bubble hidden">
		<div class="bubble-content">
			<span id="bubbleIcon">❌</span>
			<span id="bubbleText"></span>
		</div>
	</div>

	<div id="questionPanel">
		<div id="questionText">문제가 표시됩니다</div>
	</div>
	<div id="feedbackMessage"></div>

	<!-- 인트로 전체 화면 영상 -->
	<div id="introVideoScreen" class="screen">
		<video id="introVideo" src="intro.mp4.mp4" autoplay muted playsinline onerror="this.style.display='none'">
			브라우저가 비디오 태그를 지원하지 않습니다.
		</video>
	</div>

	<!-- 인트로: 게임 시작 전 설정 화면 -->
	<div id="intro" class="screen" style="display: none;">
		<div class="container">
			<div id="introHeader">
				<img id="ecoLogo" src="logo.png" alt="EcoChaser 로고">
			</div>
			<p id="introDescription">위에서 내려다보는 도시 위로 달리면서 쓰레기를 올바르게 분리수거하세요!</p>
			<div class="intro-section">
				<label for="languageSelect">언어</label>
				<select id="languageSelect">
					<option value="ko">한국어</option>
					<option value="en">English</option>
				</select>
			</div>
			<div class="intro-section">
				<label for="regionSelect">지역 선택</label>
				<select id="regionSelect">
					<option value="regions/kr_seoul.json">서울특별시</option>
					<option value="regions/kr_busan.json">부산광역시</option>
					<option value="regions/kr_incheon.json">인천광역시</option>
					<option value="regions/kr_cheonan.json">천안시</option>
				</select>
			</div>
			<!-- 로그인 없이 바로 시작하는 게임 시작 영역 -->
			<div class="intro-section intro-actions">
				<button type="button" id="startGameBtn">게임 시작</button>
				<button type="button" class="intro-home-btn intro-home-inline" onclick="window.location.href='../../index.html'">← 홈으로 돌아가기</button>
			</div>
		</div>
	</div>

	<!-- 설정 메뉴 모달 -->
	<div id="settingsModal" class="modal hidden">
		<div class="modal-content settings-menu">
			<h3>⚙️ 설정</h3>
			<div class="settings-buttons">
				<button type="button" id="quitGameBtn" class="settings-menu-btn">🏠 게임 종료</button>
				<button type="button" id="resumeGameBtn" class="settings-menu-btn secondary">▶️ 계속하기</button>
			</div>
		</div>
	</div>

	<!-- 게임 종료 확인 모달 (설정 메뉴에서 게임 종료) -->
	<div id="quitConfirmModal" class="modal hidden">
		<div class="modal-content">
			<h3 style="margin-top: 0; color: #e74c3c;">⚠️ 게임 종료</h3>
			<p style="margin: 20px 0; line-height: 1.6;">
				정말 게임을 종료하시겠습니까?<br>
				<strong>현재 진행 중인 게임은 저장되지 않으며,<br>
				점수에 반영되지 않습니다.</strong>
			</p>
			<div class="modal-buttons">
				<button type="button" id="quitConfirmBtn" style="background: #e74c3c;">게임 종료</button>
				<button type="button" id="quitCancelBtn" class="secondary">취소</button>
			</div>
		</div>
	</div>

	<!-- ESC 키 종료 확인 모달 -->
	<div id="exitModal" class="modal hidden">
		<div class="modal-content">
			<p>게임을 나가시겠습니까?<br>저장되지 않은 게임은 점수에 반영되지 않습니다.</p>
			<div class="modal-buttons">
				<button type="button" id="exitConfirmBtn">확인</button>
				<button type="button" id="exitCancelBtn" class="secondary">취소</button>
			</div>
		</div>
	</div>

	<div id="ending" class="screen">
		<div class="container">
			<h2 id="endingTitle">게임 종료!</h2>
			<p><span id="finalScoreLabel">최종 점수:</span> <span id="finalScore">0</span><span id="finalScoreUnit">점</span></p>
			
			<!-- 이름 입력 영역 -->
			<div class="name-input-section" id="nameInputSection">
				<input type="text" id="endingPlayerName" placeholder="이름을 입력하세요" maxlength="20">
				<button id="submitScoreBtn">점수 저장</button>
			</div>
			
			<div id="tierSummary">
				<div id="tierBadgeEnding"></div>
				<div id="tierInfo">
					<p id="tierNameText"></p>
					<div id="tierProgress">
						<div id="tierProgressBar"></div>
					</div>
					<p id="tierProgressText"></p>
				</div>
			</div>
			<p id="endingMessageText"></p>
			<div class="button-row">
				<button id="reviewBtn" disabled>오답노트</button>
				<button id="restartBtn">다시 시작</button>
				<button id="rankingBtn" disabled>랭킹 보기</button>
			</div>
		</div>
	</div>

	<div id="review" class="screen" style="display: none;">
		<div class="container">
			<h2>오답노트</h2>
			<div id="reviewList"></div>
			<div class="button-row">
				<button id="reviewRestartBtn">다시 시작</button>
				<button id="reviewBackBtn">닫기</button>
			</div>
		</div>
	</div>

	<div id="ranking" class="screen" style="display: none;">
		<div class="container">
			<h2 id="rankingTitle">🏆 랭킹</h2>
			
			<!-- 탭 버튼 -->
			<div class="ranking-tabs">
				<button class="tab-btn active" data-tab="region" id="regionTabBtn">지역별 랭킹</button>
				<button class="tab-btn" data-tab="personal" id="personalTabBtn">내 지역 순위</button>
				<button class="tab-btn" data-tab="stats" id="statsTabBtn">통계</button>
			</div>
			
			<!-- 지역별 랭킹 -->
			<div id="regionRanking" class="tab-content active">
				<p class="tab-description">지역별 평균 점수 순위</p>
				<div id="regionRankingList"></div>
			</div>
			
			<!-- 선택한 지역 내 개인 순위 -->
			<div id="personalRanking" class="tab-content">
				<p class="tab-description" id="personalRankingDesc">서울특별시 플레이어 순위</p>
				<div id="personalRankingList"></div>
				<p id="myRankText"></p>
			</div>
			
			<!-- 통계 그래프 -->
			<div id="statsView" class="tab-content">
				<p class="tab-description">지역별 플레이 통계</p>
				<canvas id="statsChart" width="400" height="250"></canvas>
			</div>
			
			<div class="share-buttons">
				<button id="kakaoShareBtn" class="share-btn kakao">
					<span class="kakao-icon">💬</span> 카카오톡
				</button>
				<button id="shareRankingBtn" class="share-btn general">
					📤 공유하기
				</button>
			</div>
		
			<div class="button-row">
				<button id="rankingBackBtn">확인</button>
			</div>
		</div>
	</div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
	<script src="main.js"></script>
</body>
</html>